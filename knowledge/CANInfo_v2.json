{
  "version": "2.0",
  "metadata": {
    "description": "CAN bus configuration for AiO New Dawn - Unified format for UI and implementation",
    "lastUpdated": "2025-01-12",
    "schema": "Supports drag-and-drop UI configuration and detailed CAN protocol implementation"
  },

  "functions": {
    "steering": {
      "name": "Steering",
      "color": "#3498db",
      "description": "Valve/Motor steering control",
      "exclusive": true,
      "bitValue": 1
    },
    "buttons": {
      "name": "Buttons",
      "color": "#2ecc71",
      "description": "Control button inputs",
      "exclusive": false,
      "bitValue": 2
    },
    "hitch": {
      "name": "Hitch",
      "color": "#e74c3c",
      "description": "3-point hitch control",
      "exclusive": false,
      "bitValue": 4
    },
    "implement": {
      "name": "Implement",
      "color": "#f39c12",
      "description": "ISO implement control",
      "exclusive": false,
      "bitValue": 8
    },
    "keya": {
      "name": "Keya Motor",
      "color": "#9b59b6",
      "description": "Keya CAN motor control",
      "exclusive": true,
      "bitValue": 16
    }
  },

  "busTypes": {
    "None": {
      "id": 0,
      "displayName": "None",
      "description": "Bus not configured"
    },
    "V_Bus": {
      "id": 1,
      "displayName": "V_Bus",
      "description": "Valve bus for steering",
      "defaultSpeed": 250
    },
    "K_Bus": {
      "id": 2,
      "displayName": "K_Bus",
      "description": "Tractor control bus",
      "defaultSpeed": 500
    },
    "ISO_Bus": {
      "id": 3,
      "displayName": "ISO_Bus",
      "description": "ISOBUS implement control",
      "defaultSpeed": 250
    }
  },

  "brands": [
    {
      "id": 0,
      "name": "DISABLED",
      "displayName": "Disabled",
      "description": "CAN bus disabled",
      "capabilities": {},
      "uiNotes": "CAN bus functions are disabled."
    },
    {
      "id": 1,
      "name": "CASEIH_NH",
      "displayName": "Case IH/New Holland",
      "description": "Case IH and New Holland tractors (shared V-Bus protocol)",
      "capabilities": {
        "V_Bus": ["steering"],
        "K_Bus": ["buttons", "hitch"],
        "ISO_Bus": []
      },
      "uiNotes": "V_Bus for steering • K_Bus for engage button and hitch control",

      "canConfig": {
        "VFilter": "0x0CACAA08,0x18FFBB03",
        "VSendCurve": "0x0CAD08AA",
        "SendCurve": "0,0,0,255,255,255,255,255",
        "SendCurveLoHi": "0,1",
        "ITS1": "2,253",
        "ITS0": "2,252"
      },

      "work": [
        {
          "buttonLabel": "Hitch Height",
          "bus": "K_Bus",
          "canFilterID": "0x18FE4523",
          "bits": "9-16",
          "operation": "Work",
          "type": "Range"
        }
      ],

      "models": [
        {
          "model": "Case IH General",
          "vClaim": "AA",
          "notes": "There are many different Case models with different CAN messages. Try them in turn to find what works. Typically, you can find this on the plug on rear pillar",
          "steer": [
            {
              "buttonLabel": "Case Puma CVX 160 2015, button behind joystick",
              "bus": "K_Bus",
              "canFilterID": "0x18FFB306",
              "byte": 2,
              "onStateAND": 1
            },
            {
              "buttonLabel": "Case Puma CVX 160 2015, steer button on armrest",
              "bus": "K_Bus",
              "canFilterID": "0x18FFB031",
              "byte": 2,
              "onStateAND": 16
            },
            {
              "buttonLabel": "Case Puma CVX 165 2022, steer button on armrest",
              "bus": "K_Bus",
              "canFilterID": "0x14FF7706",
              "byte": 0,
              "onStateAND": 130
            },
            {
              "buttonLabel": "Case Puma CVX 165 2022, steer button on armrest (alt 1)",
              "bus": "K_Bus",
              "canFilterID": "0x14FF7706",
              "byte": 0,
              "onStateAND": 178
            },
            {
              "buttonLabel": "Case Puma CVX 165 2022, steer button on armrest (alt 2)",
              "bus": "K_Bus",
              "canFilterID": "0x14FF7706",
              "byte": 2,
              "onStateAND": 193
            },
            {
              "buttonLabel": "Case Puma CVX 165 2022, steer button on armrest (alt 3)",
              "bus": "K_Bus",
              "canFilterID": "0x14FF7706",
              "byte": 2,
              "onStateAND": 196
            }
          ]
        },
        {
          "model": "New Holland General",
          "vClaim": "AA",
          "notes": "Steer engage is typically the button on the joystick.",
          "steer": [
            {
              "buttonLabel": "NH, steer button on joystick",
              "bus": "K_Bus",
              "canFilterID": "0x18FF1A03",
              "byte": 2,
              "onStateAND": 21
            }
          ]
        }
      ]
    },
    {
      "id": 2,
      "name": "CAT_MT",
      "displayName": "CAT MT Series",
      "description": "Caterpillar MT series tractors",
      "capabilities": {
        "V_Bus": ["steering"],
        "K_Bus": ["buttons"],
        "ISO_Bus": []
      },
      "uiNotes": null,

      "models": [
        {
          "model": "Late",
          "vClaim": "1C",
          "notes": "Later CAT MT models",
          "canConfig": {
            "VFilter": "0x18EF1CF0",
            "VSendCurve": "0x1CEFF01C",
            "SendCurve": "240,31,0,0,255,255,255,255",
            "SendCurveLoHi": "1,0",
            "ITS1": "2,253",
            "ITS0": "2,252"
          },
          "steer": [
            {
              "buttonLabel": "MT-series Engage button",
              "bus": "K_Bus",
              "canFilterID": "0x18EF1CF0",
              "byte": 0,
              "onStateAND": 15
            }
          ]
        },
        {
          "model": "Early",
          "vClaim": "2C",
          "notes": "Earlier CAT MT models",
          "canConfig": {
            "VFilter": "0x0CEFFF76",
            "VSendCurve": "0x0CEF762C",
            "SendCurve": "240,31,0,0,255,255,255,255",
            "SendCurveLoHi": "1,0",
            "ITS1": "4,253",
            "ITS0": "4,252"
          },
          "steer": [
            {
              "buttonLabel": "MT-series Engage button",
              "bus": "K_Bus",
              "canFilterID": "0x18EF1CF0",
              "byte": 0,
              "onStateAND": 15
            }
          ]
        }
      ]
    },
    {
      "id": 3,
      "name": "CLAAS",
      "displayName": "Claas",
      "description": "Claas tractors",
      "capabilities": {
        "V_Bus": ["steering"],
        "K_Bus": ["buttons"],
        "ISO_Bus": []
      },
      "uiNotes": null,

      "canConfig": {
        "VFilter": "0x0CAC1E13,0x18EF1CD2,0x1CFFE6D2",
        "VSendCurve": "0x0CAD131E",
        "SendCurve": "0,0,0,0,0,0,0",
        "SendCurveLoHi": "0,1",
        "VReceiveCurve": "0x0CAC1E13",
        "ReceiveCurveLoHi": "0,1",
        "ValveState": 2,
        "ITS1": "2,253",
        "ITS0": "2,252"
      },

      "models": [
        {
          "model": "Pre-MR",
          "vClaim": "1E",
          "notes": "Pre-MR Claas models",
          "steer": [
            {
              "buttonLabel": "Engage button",
              "bus": "K_Bus",
              "canFilterID": "0x18EF1CD2",
              "byte": 2,
              "onStateAND": 196
            }
          ],
          "work": [
            {
              "inWork": {
                "bus": "K_Bus",
                "label": "CSM1",
                "canFilterID": "0x14204146",
                "send": "0xF1,0xFC,0xFF,0xFF,0xFF,0xFF,0xFF,0x67",
                "operation": "Work"
              },
              "outWork": {
                "bus": "K_Bus",
                "label": "CSM2",
                "canFilterID": "0x14204146",
                "send": "0xF4,0xFC,0xFF,0xFF,0xFF,0xFF,0xFF,0x3F",
                "operation": "OutWork"
              }
            }
          ]
        },
        {
          "model": "Stage5",
          "vClaim": "1E",
          "notes": "Stage 5 emissions Claas models",
          "steer": [
            {
              "buttonLabel": "Engage button",
              "bus": "K_Bus",
              "canFilterID": "0x18EF1CD2",
              "byte": 2,
              "onStateAND": 196
            }
          ],
          "work": [
            {
              "inWork": {
                "bus": "K_Bus",
                "label": "CSM1",
                "canFilterID": "0x14204146",
                "send": "0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x7A",
                "operation": "Work"
              },
              "outWork": {
                "bus": "K_Bus",
                "label": "CSM2",
                "canFilterID": "0x14204146",
                "send": "0x04,0x00,0x00,0x00,0x00,0x00,0x00,0x22",
                "operation": "OutWork"
              }
            }
          ]
        }
      ]
    },
    {
      "id": 4,
      "name": "FENDT",
      "displayName": "Fendt SCR/S4/Gen6",
      "description": "Fendt SCR, S4, and Gen6 series tractors",
      "capabilities": {
        "V_Bus": ["steering"],
        "K_Bus": ["buttons", "hitch"],
        "ISO_Bus": []
      },
      "uiNotes": "K_Bus typically handles buttons and hitch • V_Bus for steering",

      "canConfig": {
        "VFilter": "0x0CEF2CF0",
        "curveMod": -32128,
        "VSendCurve": "0x0CEFF02C",
        "VDataLen": 6,
        "SendCurveSteer": "5,9,3,10,0,0",
        "SendCurveNoSteer": "5,9,2,10,0,0",
        "CurveSteerLoHi": "4,5",
        "ITS1": "2,253",
        "ITS0": "2,252"
      },

      "models": [
        {
          "model": "S4",
          "vClaim": "2C",
          "notes": "Steer engage is the white button on the armrest",
          "steer": [
            {
              "buttonLabel": "Fendt armrest button",
              "bus": "K_Bus",
              "canFilterID": "0x613",
              "byte": 1,
              "onStateAND": 4
            }
          ],
          "work": [
            {
              "inWork": {
                "bus": "K_Bus",
                "label": "Big-Go",
                "canFilterID": "0x14204146",
                "send": "0x15,0x20,0x06,0xCA,0x80,0x01,0x00,0x00",
                "operation": "Work"
              },
              "outWork": {
                "bus": "K_Bus",
                "label": "Big-End",
                "canFilterID": "0x14204146",
                "send": "0x15,0x21,0x06,0xCA,0x80,0x03,0x00,0x00",
                "operation": "OutWork"
              }
            },
            {
              "inWork": {
                "bus": "K_Bus",
                "label": "Small-Go",
                "canFilterID": "0x14204146",
                "send": "0x15,0x20,0x06,0xCA,0x80,0x01,0x00,0x00",
                "operation": "Work"
              },
              "outWork": {
                "bus": "K_Bus",
                "label": "Small-End",
                "canFilterID": "0x14204146",
                "send": "0x15,0x21,0x06,0xCA,0x80,0x03,0x00,0x00",
                "operation": "OutWork"
              }
            }
          ]
        }
      ]
    },
    {
      "id": 5,
      "name": "FENDT_ONE",
      "displayName": "Fendt One",
      "description": "Fendt One series tractors",
      "capabilities": {
        "V_Bus": ["steering"],
        "K_Bus": ["buttons", "hitch"],
        "ISO_Bus": ["steering", "implement"]
      },
      "uiNotes": null,

      "canConfig": {
        "VFilter": "0x0CEF2CF0",
        "VBusBaud": 500000
      },

      "models": [
        {
          "model": "FendtOne",
          "vClaim": "2C",
          "notes": "FendtOne steer engage button",
          "steer": [
            {
              "buttonLabel": "FendtOne Engage button",
              "bus": "K_Bus",
              "canFilterID": "0xCFFD899",
              "byte": 3,
              "onStateAND": 246
            }
          ]
        }
      ]
    },
    {
      "id": 6,
      "name": "GENERIC",
      "displayName": "Generic",
      "description": "Generic/mixed configuration for custom setups",
      "capabilities": {
        "V_Bus": ["steering"],
        "K_Bus": ["buttons", "hitch"],
        "ISO_Bus": ["steering", "implement"],
        "None": ["keya"]
      },
      "allowsKeya": true,
      "uiNotes": "Use when mixing functions from different brands or using Keya steering"
    },
    {
      "id": 7,
      "name": "JCB",
      "displayName": "JCB",
      "description": "JCB tractors",
      "capabilities": {
        "V_Bus": ["steering"],
        "K_Bus": [],
        "ISO_Bus": []
      },
      "uiNotes": null,

      "canConfig": {
        "VFilter": "0x0CACAB13,0x18EFAB27",
        "VSendCurve": "0x0CAD13AB",
        "SendCurve": "0,0,0,255,255,255,255,255",
        "SendCurveLoHi": "0,1",
        "ITS1": "2,253",
        "ITS0": "2,252"
      },

      "models": [
        {
          "model": "General",
          "vClaim": "AB",
          "notes": "General JCB configuration",
          "steer": [
            {
              "buttonLabel": "Engage button",
              "bus": "K_Bus",
              "canFilterID": "0x18EFAB27",
              "byte": 2,
              "onStateAND": 1
            }
          ]
        }
      ]
    },
    {
      "id": 8,
      "name": "LINDNER",
      "displayName": "Lindner",
      "description": "Lindner tractors",
      "capabilities": {
        "V_Bus": ["steering"],
        "K_Bus": [],
        "ISO_Bus": []
      },
      "uiNotes": null,

      "canConfig": {
        "VFilter": "0x0CACF013,0x0CEFF021",
        "VSendCurve": "0x0CAD13F0",
        "SendCurve": "255,255,255,255,255,255,255",
        "SendCurveLoHi": "0,1",
        "ITS1": "2,253",
        "ITS0": "2,252"
      },

      "models": [
        {
          "model": "General",
          "vClaim": "F0",
          "notes": "General Lindner configuration",
          "steer": [
            {
              "buttonLabel": "Engage button",
              "bus": "K_Bus",
              "canFilterID": "0x18EF1CF0",
              "byte": 0,
              "onStateAND": 15
            }
          ]
        }
      ]
    },
    {
      "id": 9,
      "name": "VALTRA_MASSEY",
      "displayName": "Valtra/Massey Ferguson",
      "description": "Valtra and Massey Ferguson tractors (shared protocol)",
      "capabilities": {
        "V_Bus": ["steering"],
        "K_Bus": ["buttons", "hitch"],
        "ISO_Bus": []
      },
      "uiNotes": "V_Bus steering only - requires continuous valve ready messages",

      "canConfig": {
        "VFilter": "0x0CAC1C13,0x18EF1C32",
        "VSendCurve": "0x0CAD131C",
        "SendCurve": "0,0,0,0,0,0,0",
        "SendCurveLoHi": "0,1",
        "VReceiveCurve": "0x0CAC1E13",
        "ReceiveCurveLoHi": "0,1",
        "ITS1": "2,253",
        "ITS0": "2,252"
      },

      "work": [
        {
          "buttonLabel": "PTO",
          "bus": "K_Bus",
          "canFilterID": "0x45a",
          "byte": 1,
          "onStateAND": 4,
          "operation": "Work",
          "type": "State"
        },
        {
          "buttonLabel": "Hitch Height",
          "bus": "K_Bus",
          "canFilterID": "0x45a",
          "bits": "9-16",
          "operation": "Work",
          "type": "Range"
        }
      ],

      "models": [
        {
          "model": "Massey Ferguson 6000 Series",
          "vClaim": "AA",
          "notes": "Steer engage is typically the headland management button on the joystick, or autosteer button if fitted",
          "steer": [
            {
              "buttonLabel": "6000 series Headland management button",
              "bus": "K_Bus",
              "canFilterID": "0x45a",
              "byte": 1,
              "onStateAND": 4,
              "operation": "Work"
            }
          ]
        },
        {
          "model": "Massey Ferguson S-Series",
          "vClaim": "AA",
          "notes": "Steer engage is typically the headland management button on the joystick, or autosteer button if fitted",
          "steer": [
            {
              "buttonLabel": "S-series Steering engage button",
              "bus": "K_Bus",
              "canFilterID": "0xCFF2621",
              "byte": 3,
              "onStateAND": 4
            }
          ],
          "work": [
            {
              "buttonLabel": "PTO (S-Series override example)",
              "bus": "K_Bus",
              "canFilterID": "0x445545a",
              "byte": 1,
              "onStateAND": 4,
              "operation": "Work",
              "type": "State"
            }
          ]
        },
        {
          "model": "Massey Ferguson 7000-Series",
          "vClaim": "AA",
          "notes": "Steer engage is typically the headland management button on the joystick, or autosteer button if fitted",
          "steer": [
            {
              "buttonLabel": "7000-series Steering engage button",
              "bus": "K_Bus",
              "canFilterID": "0x210",
              "byte": 1,
              "onStateAND": 21
            }
          ]
        },
        {
          "model": "Valtra General",
          "vClaim": "1C",
          "notes": "Valtra tractors with standard engage button",
          "steer": [
            {
              "buttonLabel": "Engage button",
              "bus": "K_Bus",
              "canFilterID": "0x18EF1C32",
              "byte": 2,
              "onStateAND": 1
            },
            {
              "buttonLabel": "Engage button (alternative)",
              "bus": "K_Bus",
              "canFilterID": "0x18EF1C00",
              "byte": 2,
              "onStateAND": 196
            }
          ]
        }
      ]
    }
  ]
}
